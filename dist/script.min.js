/*! dw 09-02-2016 */
function detectType(a){if(a instanceof Array){if(a.length>0)return"number"==typeof a[0]||"string"==typeof a[0]?TypeChart.Histogram:a[0]instanceof Array?TypeChart.StackedBar:a[0]instanceof Object?TypeChart.Scatter:TypeChart.Unknown}else if(a instanceof Object)return TypeChart.Line}function loadLib(a){function b(){window.d3&&window.nv?a():setTimeout(b,100)}dw.d3lib?b():(dw.d3lib=document.createElement("script"),dw.d3lib.type="text/javascript",dw.d3lib.charset="UTF-8",dw.d3lib.src="https://cdnjs.cloudflare.com/ajax/libs/d3/3.5.2/d3.js",dw.d3lib.onload=function(a){return function(){if("undefined"==typeof dw.nvlib){var c=document.createElement("link");c.rel="stylesheet",c.type="text/css",c.href="../node_modules/nvd3/build/nv.d3.css",document.head.appendChild(c),dw.nvlib=document.createElement("script"),dw.nvlib.type="text/javascript",dw.nvlib.src="../node_modules/nvd3/build/nv.d3.js",dw.nvlib.onload=a,document.head.appendChild(dw.nvlib),function(){var a={"html, body, div":"margin: 0px;padding: 0px;","#chartsContainer svg":"position: relative;min-height: 1px;padding-right: 0px;padding-left: 0px;float: left;height: 45%;width:30%;","#chartsContainer":"overflow:hidden;width: 100%;",".last-row":"width:30%;"};for(var b in a)dw.addStyleRule(b,a[b])}()}else b()}}(a),document.head.appendChild(dw.d3lib))}function draw(){function a(){var a=dw._chartId++;return c=c||document.getElementById("chartsContainer")||function(){var a=document.createElement("div");return a.id="chartsContainer",a.style.cssText="overflow:hidden; width: 100%;",a.style.height=window.innerHeight-16+"px",document.body.appendChild(a),window.onresize=function(){a.style.height=window.innerHeight-16+"px",a.style.width=window.innerWidth-16+"px"},document.body.appendChild(a),a}(),c.appendChild(function(a){var b=document.createElementNS("http://www.w3.org/2000/svg","svg");return b.id="chart"+a,b}(a)),a}function b(){var b,c;switch(detectType(d)){case TypeChart.Line:b=a(),c=dw.adapters.toLine(d),dw.charts.Line(b,c);break;case TypeChart.Scatter:b=a(),c=dw.adapters.toScatter(d),dw.charts.Scatter(b,c);break;case TypeChart.Histogram:b=a(),c=dw.adapters.toHistogram(d),dw.charts.Histogram(b,c);break;case TypeChart.StackedBar:b=a(),c=dw.adapters.toStackedBar(d),dw.charts.StackedBar(b,c);break;default:console.log("Unavalible chart")}}var c,d=this;console.log("Drawing chart type: ",TypeChart[detectType(this)]),console.log("Source data",this),dw.loadLib(b)}!function(a){var b;!function(a){function b(a){var b={};a.forEach(function(a,c,d){a in b?b[a]+=1:b[a]=1});var c=[{key:"Cumulative Return",values:[]}];for(var d in b)c[0].values.push({label:d,value:b[d]});return c}function c(a){return[{key:"Data ",values:a}]}function d(a){var b=[];for(var c in a){var d=a[c].map(function(a,b){return{x:b,y:a}});b.push({key:c,values:d})}return b}function e(a){var b=[];if(a.length>0){var c=a.reduce(function(a,b){return Math.max(a,b.length-1)},0);b=a.map(function(a,b){return{key:a[0],values:a.slice(1,c+1).slice(0,c).concat(Array(Math.abs(c-Math.min(a.length-1,c))+1).join(",0").split(",").splice(1).map(function(a){return Number(a)})).map(function(a,b){return{x:b,y:a}})}})}return b}a.toHistogram=b,a.toScatter=c,a.toLine=d,a.toStackedBar=e}(b=a.adapters||(a.adapters={}))}(dw||(dw={})),function(a){var b;!function(b){function c(b){a.graphs.push(b),a.refreshStyle()}function d(a,b){nv.addGraph(function(){var c=nv.models.discreteBarChart().x(function(a){return a.label}).y(function(a){return a.value}).staggerLabels(!0).showValues(!0).duration(250);return d3.select("#chart"+a).datum(b).call(c),nv.utils.windowResize(c.update),c},c)}function e(a,b){nv.addGraph(function(){var c=nv.models.scatterChart().pointSize(function(a){return a.r}).showDistX(!0).showDistY(!0).duration(300).color(d3.scale.category10().range());return c.xAxis.tickFormat(d3.format(".2f")),c.yAxis.tickFormat(d3.format(".2f")),d3.select("#chart"+a).datum(b).call(c),nv.utils.windowResize(c.update),c},c)}function f(a,b){nv.addGraph(function(){var c=nv.models.lineChart();return c.dispatch.on("renderEnd",function(){console.log("render line chart complete")}),c.xAxis.tickFormat(d3.format(".02f")),c.yAxis.tickFormat(d3.format(".02f")),d3.select("#chart"+a).datum(b).call(c),nv.utils.windowResize(c.update),c},c)}function g(a,b){nv.addGraph(function(){var c=nv.models.multiBarChart().barColor(d3.scale.category20().range()).stacked(!0).options({showControls:!1}).duration(250).rotateLabels(360).groupSpacing(.3);return c.reduceXTicks(!1).staggerLabels(!0),c.xAxis.axisLabelDistance(5).showMaxMin(!1).tickFormat(d3.format(",.0f")),c.yAxis.axisLabelDistance(-5).tickFormat(d3.format(",.01f")),c.dispatch.on("renderEnd",function(){nv.log("Render Complete")}),d3.select("#chart"+a).datum(b).call(c),nv.utils.windowResize(c.update),c.dispatch.on("stateChange",function(a){nv.log("New State:",JSON.stringify(a))}),c.state.dispatch.on("change",function(a){nv.log("state",JSON.stringify(a))}),c},c)}b.Histogram=d,b.Scatter=e,b.Line=f,b.StackedBar=g}(b=a.charts||(a.charts={}))}(dw=dw||{});var TypeChart;!function(a){a[a.Unknown=0]="Unknown",a[a.Histogram=1]="Histogram",a[a.Scatter=2]="Scatter",a[a.Line=3]="Line",a[a.StackedBar=4]="StackedBar"}(TypeChart||(TypeChart={}));var dw;!function(a){function b(b,c){if(!a.styleSheet){var d=document.createElement("style");d.appendChild(document.createTextNode("")),document.head.appendChild(d),a.styleSheet=d.sheet}var e=a.styleSheet;e.insertRule?e.insertRule(b+"{"+c+"}",0):e.addRule?e.addRule(b,c,0):console.warn("addStyleRule failed")}function c(a){var b=Math.sqrt(window.innerHeight*a/window.innerWidth);b=Math.floor(b)==b?b:Math.floor(b)+1;var c=a/b;return c=Math.floor(c)==c?c:Math.floor(c)+1,{col:c,row:b}}function d(a,b){return Array.prototype.filter.call(a.rules,function(a){return function(b){return b.selectorText===a}}(b))}function e(a,b){return d(a,b)[0]||null}function f(){var b=a.graphs.length;if(b){g.forEach(function(a){a.container.style.width=""});var d=c(b),f=d.row,h=d.col,i=e(a.styleSheet,"#chartsContainer svg");i&&i.style&&(i.style.width=Math.floor(1/h*100)+"%",i.style.height=Math.floor(1/f*100)+"%"),d.col*d.row>b&&a.graphs.slice(h*(f-1)).forEach(function(a){return function(b,c){b.container.style.width=a}}(Math.floor(100/(b%(h*(f-1))))+"%")),a.graphs.forEach(function(a){a.update()})}}a.addStyleRule=b,a.tableSize=c,a.refreshStyle=f;var g=[];a.graphs=g,a._chartId=0}(dw=dw||{}),dw.loadLib=loadLib,Object.defineProperty(Object.prototype,"draw",{enumerable:!1,value:draw});